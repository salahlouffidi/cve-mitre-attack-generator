import csv
import openai

openai.api_key = "YOUR_API_KEY"

filename = "trans.csv"

with open(filename, "r", encoding="utf-8") as file:
    reader = csv.reader(file)
    cve_ids = [row[0].strip() for row in reader]

print("CVE IDs:")
for cve_id in cve_ids:
    print(cve_id)

    prompt = f"Write me the MITRE ATT&CK technique for CVE {cve_id}."

    response = openai.Completion.create(
        engine="text-davinci-003",
        prompt=prompt,
        max_tokens=100,
        n=1,
        stop=None,
        temperature=0.7,
    )

    mitre_technique = response.choices[0].text.strip()

    print(f"MITRE ATT&CK Technique: {mitre_technique}")
